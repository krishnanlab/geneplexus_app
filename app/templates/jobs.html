{% extends "base.html" %}

{% block title %}GenePlexus | Jobs{% endblock %}

{% block app_content %}

<style>

</style>

<div class="container">
    
    {% include 'messages.html' ignore missing %}

    <h4>Job Runtime</h4>
    <p>While many jobs will only take a few minutes to complete, some networks and feature types require training machine learning models that use 10s of GBs of memory, have more that 25,000 features and use thousands of positive and negative labeled genes. Therefore, some jobs may take up to 10 minutes or more and this time can vary due to latency speeds on Microsoft Azure.</p>
    <hr>
    <h4 >Jobs Submitted for this session</h4>
        
    {% if joblist %}
        <hr>
        <table class="table w-100" style="width:100%;" id="jobstable">
            <thead>
                <tr >
                <th>Job Name</th>
                <th>Submit Time</th>
                <th>Parameters</th>
                <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for job in joblist %}
                
                <tr id="job-{{job['jobname']}}" class="{{'table-success' if job['has_results'] }}" >
                    <td> 
                        {% if job['has_results'] %}
                            <a href="{{url_for('job',jobname=job['jobname']) }}">{{job['jobname']}}</a>
                        {% else %}
                            {{job['jobname']}}
                        {% endif %}
                    </td>
                        
                    </td>
                    <td>{{job['submit_time']}}</td>
                    <td>{% if job['params'] %}
                        {{job['params']['GP_NET_TYPE']}}; {{job['params']['GP_FEATURES']}}; {{job['params']['GP_GSC']}}
                        {% endif %}
                    </td>
                    <td>{{job['status']}}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        
        <p style="padding-top:1em;">No recent jobs in session. You search for one on the left, or start a new one on our <a href="{{url_for('index')}}">home page</a>  </p>
        {% endif %}
        <br>
        <hr>
    
        <div class="item-content">
            <h4>Job Lookup</h4>
            <form class="form" method="post">
                <fieldset class="border box_padding fieldset">
                    <div class="row">
                    <label class="col-md-3" for="jobname">
                    Recall job results by name
                    </label>&nbsp<a href="#" data-toggle="popover" data-trigger="hover" data-placement="right"
                           data-content="Only jobs from this browser session are available in this list. Enter the job name (name only) to find a previous job (exact match)
                           or copy and paste the job url in your browser.">
                             <i class="fas fa-question-circle"></i></a>
                
            {{ form.jobname(class="form-control col", placeholder="job name") }}

            {{ form.lookup(class_="btn btn-sm btn-primary col")}}
                    </div>
            </fieldset>
            </form>      
        </div>
    </div>
{% endblock %}



{% block scripts %}
<script>
/*
Commenting out in case we want to use later with the same formatting
$(document).ready( function () {
    $('#jobstable').DataTable({
        "lengthChange": false,
        "pageLength": 20,
        "autoWidth": false,
        "responsive": false,
        "filter": false,
        "order": [[ 1, "asc" ]]
    });

});
*/
// 
</script>

{% endblock %}
